card_query:
  handler: api.card_query
  memorySize: 256
  timeout: 900
  maximumRetryAttempts: 0
  layers:
    - {Ref: PythonRequirementsLambdaLayer}
  events:
    - http:
        path: card_query
        method: post
        cors: true
    - schedule:
        name: card_query_warmup-${self:custom.stage}
        description: 'keep card query api warm'
        rate: rate(10 minutes)
        enabled: true
        input:
          key: "name"
          value: "Audacious Thief"
  fileSystemConfig:
    localMountPath: '/mnt${self:custom.data_prep_mnt_path}'
    arn: ${cf:magicml-common-${self:custom.stage}.accessPointAArn}

free_text_query:
  image:
    uri: ${self:custom.tf_image}
    command:
      - api.free_text_query
    entryPoint:
      - '/lambda-entrypoint.sh'
  memorySize: 5000
  timeout: 120
  maximumRetryAttempts: 0
  environment:
      CONTAINER_ENV: 'True'
  events:
    - http:
        path: free_text_query
        method: post
        cors: true
    - schedule:
        name: free_text_warmup-${self:custom.stage}
        description: 'keep free text api warm'
        rate: rate(10 minutes)
        enabled: true
        input:
          query: ["warming up"]
  fileSystemConfig:
    localMountPath: '/mnt${self:custom.data_prep_mnt_path}'
    arn: ${cf:magicml-common-${self:custom.stage}.accessPointAArn}